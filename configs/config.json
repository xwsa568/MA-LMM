{
  "model": {
    "arch": "VideoChat2",
    "model_type": "vicuna7b",
    "model_cls": "VideoChat2_it_vicuna",
    "vit_blip_model_path": "checkpoints/umt_l16_qformer.pth",
    "llama_model_path": "checkpoints/vicuna-7b-delta-v0",
    "videochat2_model_path": "checkpoints/videochat2_7b_stage3.pth",
    "freeze_vit": false,
    "freeze_qformer": false,
    "max_txt_len": 512,
    "low_resource": false,
    "vision_encoder": {
      "name": "vit_l14",
      "img_size": 224,
      "patch_size": 16,
      "d_model": 1024,
      "encoder_embed_dim": 1024,
      "encoder_depth": 24,
      "encoder_num_heads": 16,
      "drop_path_rate": 0.0,
      "num_frames": 8,
      "tubelet_size": 1,
      "use_checkpoint": false,
      "checkpoint_num": 0,
      "pretrained": "",
      "return_index": -2,
      "vit_add_ln": true,
      "ckpt_num_frame": 4
    },
    "memory_bank_length": 20,
    "num_frames": 16,
    "num_query_token": 32,
    "qformer_hidden_dropout_prob": 0.1,
    "qformer_attention_probs_dropout_prob": 0.1,
    "qformer_drop_path_rate": 0.2,
    "extra_num_query_token": 64,
    "qformer_text_input": true,
    "system": "",
    "start_token": "<Video>",
    "end_token": "</Video>",
    "img_start_token": "<Image>",
    "img_end_token": "</Image>",
    "random_shuffle": true,
    "use_lora": true,
    "lora_r": 16,
    "lora_alpha": 32,
    "lora_dropout": 0.1
  },
  "datasets": {
    "lvu_cls": {
      "vis_processor": {
          "train": {
            "name": "videochat2_train",
            "image_size": 224
          },
          "eval": {
            "name": "videlchat2_eval",
            "image_size": 224
          }
      },
      "text_processor": {
          "train": {
            "name": "blip_caption",
            "prompt": ""
          },
          "eval": {
            "name": "blip_caption",
            "prompt": ""
          }
      },
      "history": 10,
      "num_videos": 16,
      "task": "relationship",
      "stride": 10
    }
  },
  "run":{
    "task": "classification",
    "init_lr:": 1e-5,
    "lr_sched": "linear_warmup_cosine_lr",
    "min_lr": 0,
    "warmup_lr": 1e-8,
    "warmup_steps": 1000,
    "weight_decay": 0.05,
    "max_epoch": 10,
    "batch_size_train": 16,
    "batch_size_eval": 16,
    "num_workers": 12,
    "accum_grad_iters": 1,

    "max_len": 5,
    "min_len": 1,
    "num_beams": 5,

    "seed": 42,
    "output_dir": "output",

    "resume_ckpt_path": null,
    "amp": "True",

    "evaluate": "False",
    "train_splits": ["train"],
    "valid_splits": ["val"],
    "test_splits": ["test"],

    "world_size": 1,
    "dist_url": "env://",
    "distributed": "True",
    "report_metric": "True",
    "suffix" : null
  },
  "device": "cuda"
}
